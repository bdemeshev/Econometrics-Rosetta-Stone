## R

Загружаем нужные пакеты:
```{r "packages", include=TRUE, warning=FALSE, message=FALSE}
library(dplyr) # работа с данными
library(ggplot2) # построение графиков
library(skimr) # изучение данных
library(FactoMineR) # анализ главных компонент
library(factoextra) # визуализация главных компонент 
```

Загружаем набор данных по параметрам машин **mtcars** и изучаем его строение:
```{r "dataset"}
skim(mtcars)
```

Целевая переменная в данном наборе данных - это `mpg`, miles per gallon. Для МГК нам понадобится произвести стандартизацию регрессоров, так как разные переменные измерены в несопоставимых единицах измерения: 
```{r "pca"}
c = select(mtcars, -mpg) # сохраняем регрессоры в отдельный список
c_pca = PCA(c, scale.unit = TRUE, graph = FALSE) # применяем функцию PCA для нахождения главных компонент, при этом проводим их стандартизацию (scale.unit=TRUE)
```

Используя возможности пакета **factoextra**, построим несколько графиков, чтобы иметь полное представление о созданных главных компонентах. Для начала визуализируем долю объясняемой главными компонентами дисперсии с помощью функции *fviz_eig*:
```{r "pca decomposition"}
fviz_eig(c_pca, addlabels = TRUE, ylim = c(0, 65), barfill = "dodgerblue2", barcolor = "dodgerblue4", linecolor = "black", title = "Доля объясняемой дисперсии")
```

Итак, две первые главные компоненты, PC1 и PC2, объясняют более 85% дисперсии.

Посмотрим, в каких переменных содержится больше всего информации, т.е. какие из них вносят наибольший вклад в объяснение дисперсии, с помощью функции *fviz_contrib*. 
```{r "pca contribution"}
fviz_contrib(c_pca, choice = "var", axes = 1:2, top = 10, fill = "darkseagreen2", linecolor = "black", title = "Вклад переменных в первую и вторую главные компоненты")
```

Соответственно, наибольшая информация содержится в переменных `cyl`, `disp`, `qsec`.

Построим так называемый **Correlation Circle**, показывающий корреляцию между исходными переменными и главными компонентами, используя функцию *fviz_pca_var*. Покажем вклад переменных в первую и вторую главные компоненты цветом:
```{r "correlation circle"}
fviz_pca_var(c_pca, col.var = "contrib",
             gradient.cols = c("#00AFBB", "#E7B800", "#FC4E07"),
             title = "Корреляция между исходными переменными и главными компонентами")
```

Переменные с положительной корреляцией расположены близко друг к другу (например, `cyl` и `hp`), с отрицательной корреляцией - на противоположных частях графика (`drat` и `wt`). Чем больше дистанция между переменными и началом координат, тем лучше их удается описать при помощи главных компонент.